{% extends "base.html" %}
{% block content %}
<div class="row g-4">
  <div class="col-lg-7">
    <div class="card p-3">
      <h5>1. Upload de CSV</h5>
      <p class="text-secondary mb-2">Carregue um arquivo .csv (mesma estrutura nas substituições). O modelo pode ser re-treinado após o upload.</p>
      <form action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data" class="d-flex gap-2">
        <input class="form-control" type="file" name="file" accept=".csv" required>
        <button class="btn btn-primary">Enviar</button>
      </form>
      {% if have_data %}
      <div class="mt-3">
        <span class="badge text-bg-success">Dataset ativo: {{ path }}</span>
      </div>
      {% endif %}
    </div>

    <div class="card p-3 mt-4">
      <h5>2. Dicionário de Dados</h5>
      {% if have_data %}
        <div class="table-responsive">
          <table class="table table-sm align-middle">
            <thead><tr><th>Coluna</th><th>Tipo</th></tr></thead>
            <tbody>
              {% for c in cols %}
              <tr>
                <td class="fw-medium">{{ c }}</td>
                <td>
                  {% if c in num_cols %}<span class="badge text-bg-info">numérica</span>
                  {% else %}<span class="badge text-bg-secondary">categórica</span>{% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p class="text-secondary">Envie um CSV para visualizar o dicionário.</p>
      {% endif %}
    </div>
  </div>

  <div class="col-lg-5">
    <div class="card p-3">
      <h5>3. Modelos Treinados</h5>
      {% if models %}
        <ul class="list-group">
          {% for m in models %}
          <li class="list-group-item bg-dark text-light">
            <div class="d-flex justify-content-between">
              <div>
                <div class="fw-bold">{{ m.id }}</div>
                <small>Target: {{ m.target }} | Task: {{ m.task }}</small><br>
                <small>Features: {{ m.features }}</small><br>
                <small>Métricas: {{ m.metrics }}</small>
              </div>
            </div>
          </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-secondary">Nenhum modelo salvo ainda.</p>
      {% endif %}
      <a class="btn btn-primary mt-3" href="{{ url_for('dashboard') }}">Abrir Dashboard</a>
    </div>
  </div>
</div>
{% endblock %}
